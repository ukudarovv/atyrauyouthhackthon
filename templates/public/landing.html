<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <!-- SEO –º–µ—Ç–∞-—Ç–µ–≥–∏ -->
    <title>{{ landing.seo_title|default:camp.name }}</title>
    <meta name="description" content="{{ landing.seo_desc|default:camp.description|truncatechars:150 }}">
    
    <!-- Open Graph –¥–ª—è —Å–æ—Ü.—Å–µ—Ç–µ–π -->
    <meta property="og:title" content="{{ landing.seo_title|default:camp.name }}">
    <meta property="og:description" content="{{ landing.seo_desc|default:camp.description|truncatechars:150 }}">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
    {% if landing.og_image %}
        <meta property="og:image" content="{{ request.scheme }}://{{ request.get_host }}{{ landing.og_image.url }}">
    {% elif landing.hero_image %}
        <meta property="og:image" content="{{ request.scheme }}://{{ request.get_host }}{{ landing.hero_image.url }}">
    {% endif %}
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ landing.seo_title|default:camp.name }}">
    <meta name="twitter:description" content="{{ landing.seo_desc|default:camp.description|truncatechars:150 }}">
    {% if landing.og_image %}
        <meta name="twitter:image" content="{{ request.scheme }}://{{ request.get_host }}{{ landing.og_image.url }}">
    {% endif %}
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéØ</text></svg>">
    
    <!-- –°—Ç–∏–ª–∏ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --primary-color: {{ landing.primary_color|default:"#111827" }};
        }
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        .btn-primary:hover {
            filter: brightness(0.9);
        }
        .text-primary {
            color: var(--primary-color);
        }
        .border-primary {
            border-color: var(--primary-color);
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100">
    <main class="min-h-screen flex items-center justify-center p-4">
        <div class="max-w-2xl w-full">
            <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –ª–µ–Ω–¥–∏–Ω–≥–∞ -->
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
                <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
                {% if landing.hero_image %}
                <div class="w-full h-64 sm:h-80 overflow-hidden">
                    <img src="{{ landing.hero_image.url }}" 
                         class="w-full h-full object-cover" 
                         alt="{{ landing.headline|default:camp.name }}">
                </div>
                {% endif %}
                
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
                <div class="p-8 sm:p-12">
                    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
                    <h1 class="text-3xl sm:text-4xl font-bold text-primary mb-6 leading-tight">
                        {{ landing.headline|default:camp.name }}
                    </h1>
                    
                    <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
                    {% if landing.body_md %}
                    <div class="prose prose-lg max-w-none text-gray-700 mb-8">
                        {{ landing.body_md|linebreaks }}
                    </div>
                    {% elif camp.description %}
                    <div class="prose prose-lg max-w-none text-gray-700 mb-8">
                        {{ camp.description|linebreaks }}
                    </div>
                    {% endif %}
                    
                    <!-- –£—Å–ª–æ–≤–∏—è -->
                    {% if camp.terms %}
                    <div class="bg-gray-50 rounded-lg p-4 mb-6">
                        <h3 class="font-semibold text-gray-900 mb-2">–£—Å–ª–æ–≤–∏—è —É—á–∞—Å—Ç–∏—è:</h3>
                        <div class="text-sm text-gray-600">
                            {{ camp.terms|linebreaks }}
                        </div>
                    </div>
                    {% endif %}
                    
                    <!-- CTA —Å–µ–∫—Ü–∏—è -->
                    {% if camp.is_running_now %}
                    <div class="text-center">
                        <a href="{% url 'coupons:claim' camp.slug %}{% if query_string %}?{{ query_string }}{% endif %}"
                           class="inline-block w-full sm:w-auto btn-primary text-white font-semibold py-4 px-8 rounded-xl text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
                            üé´ {{ landing.cta_text|default:"–ü–æ–ª—É—á–∏—Ç—å –∫—É–ø–æ–Ω" }}
                        </a>
                        
                        <!-- QR-–∫–æ–¥ -->
                        <div class="mt-6 flex flex-col sm:flex-row items-center justify-center gap-4">
                            <img src="{% url 'coupons:landing_qr' camp.slug %}" 
                                 alt="QR-–∫–æ–¥" 
                                 class="w-20 h-20 rounded-lg border-2 border-gray-200" />
                            <div class="text-sm text-gray-600 text-center sm:text-left">
                                <p class="font-medium">–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å –¥—Ä—É–∑—å—è–º–∏</p>
                                <p>–û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR-–∫–æ–¥</p>
                            </div>
                        </div>
                        
                        <!-- –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è -->
                        {% if camp.ends_at %}
                        <p class="text-sm text-gray-500 mt-4">
                            ‚è∞ –î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ {{ camp.ends_at|date:"d.m.Y –≤ H:i" }}
                        </p>
                        {% endif %}
                        
                        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∏–∑–Ω–µ—Å–µ -->
                        <div class="mt-8 pt-6 border-t border-gray-200">
                            <div class="flex items-center justify-center space-x-4 text-sm text-gray-600">
                                <span class="font-medium">{{ camp.business.name }}</span>
                                {% if camp.business.phone %}
                                    <span>üìû {{ camp.business.phone }}</span>
                                {% endif %}
                                {% if camp.location %}
                                    <span>üìç {{ camp.location.name }}</span>
                                {% endif %}
                            </div>
                            {% if camp.business.address %}
                            <p class="text-center text-sm text-gray-500 mt-2">
                                {{ camp.business.address }}
                            </p>
                            {% endif %}
                        </div>
                    </div>
                    {% else %}
                    <!-- –ê–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ -->
                    <div class="text-center py-8">
                        <div class="bg-gray-100 rounded-xl p-6">
                            <div class="text-4xl mb-4">üòî</div>
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">–ê–∫—Ü–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞</h3>
                            <p class="text-gray-600">
                                {% if camp.ends_at and camp.ends_at < now %}
                                    –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –∞–∫—Ü–∏–∏ –∏—Å—Ç–µ–∫ {{ camp.ends_at|date:"d.m.Y" }}
                                {% elif camp.starts_at and camp.starts_at > now %}
                                    –ê–∫—Ü–∏—è –Ω–∞—á–Ω–µ—Ç—Å—è {{ camp.starts_at|date:"d.m.Y –≤ H:i" }}
                                {% else %}
                                    –ê–∫—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
                                {% endif %}
                            </p>
                        </div>
                        
                        <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è —Å–≤—è–∑–∏ -->
                        <div class="mt-6">
                            <p class="text-sm text-gray-600 mb-2">–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π:</p>
                            <div class="flex items-center justify-center space-x-4 text-sm">
                                <span class="font-medium">{{ camp.business.name }}</span>
                                {% if camp.business.phone %}
                                    <a href="tel:{{ camp.business.phone }}" class="text-primary hover:underline">
                                        üìû {{ camp.business.phone }}
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- –î–æ–≤–µ—Ä–∏–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å -->
            <div class="text-center mt-6">
                <p class="text-xs text-gray-500">
                    üîí –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ ‚Ä¢ üéØ –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ—Ç {{ camp.business.name }}
                </p>
            </div>
        </div>
    </main>

    <!-- –ü—Ä–æ—Å—Ç–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
    <script>
        // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∑–¥–µ—Å—å
        console.log('Landing viewed:', '{{ camp.slug }}');
        
        // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
        let startTime = Date.now();
        window.addEventListener('beforeunload', function() {
            let timeSpent = Math.round((Date.now() - startTime) / 1000);
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
            console.log('Time spent:', timeSpent, 'seconds');
        });
    </script>
</body>
</html>
