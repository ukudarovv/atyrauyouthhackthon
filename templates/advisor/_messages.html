{% for message in messages %}
    <div class="mb-4 flex {% if message.role == 'user' %}justify-end{% else %}justify-start{% endif %}">
        <div class="max-w-xs lg:max-w-md px-4 py-2 rounded-lg {% if message.role == 'user' %}bg-blue-600 text-white{% else %}bg-gray-100 text-gray-900{% endif %}">
            {% if message.role == 'assistant' %}
                <div class="flex items-start">
                    <span class="text-lg mr-2 flex-shrink-0">ü§ñ</span>
                    <div class="flex-1">
                        {% if message.content.mode == 'quick' %}
                            <div class="text-xs text-green-600 mb-1">‚ö° –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–≤–µ—Ç</div>
                        {% elif message.content.mode == 'rule_based' %}
                            <div class="text-xs text-blue-600 mb-1">üéØ –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç</div>
                        {% elif message.content.mode == 'analytics' %}
                            <div class="text-xs text-purple-600 mb-1">üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</div>
                        {% endif %}
                        {{ message.content.text|linebreaks|safe }}
                    </div>
                </div>
            {% else %}
                {{ message.content.text }}
            {% endif %}
            <div class="text-xs mt-1 {% if message.role == 'user' %}text-blue-200{% else %}text-gray-500{% endif %}">
                {{ message.created_at|date:"H:i" }}
            </div>
        </div>
    </div>
{% empty %}
    <div class="text-center text-gray-500 py-8">
        <div class="text-4xl mb-4">ü§ñ</div>
        <h3 class="text-lg font-medium mb-2">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ AI –°–æ–≤–µ—Ç—á–∏–∫!</h3>
        <p class="text-sm">–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ –≤–∞—à–∏—Ö –º–µ—Ç—Ä–∏–∫–∞—Ö –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –±—ã—Å—Ç—Ä—ã–π –≤–æ–ø—Ä–æ—Å –Ω–∏–∂–µ.</p>
    </div>
{% endfor %}
